<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>JoJo — галерея</title>
<style>
  :root { --accent: #e94560; --muted: #bbb; }
  body { margin:0; min-height:100vh; display:flex; align-items:center; justify-content:center; background:#0f0f13; font-family:Arial, Helvetica, sans-serif; color:#fff; }
  .gallery-wrapper { width:90%; max-width:1100px; background:rgba(255,255,255,0.03); padding:18px;border-radius:12px; box-shadow:0 10px 30px rgba(0,0,0,0.6); position:relative; overflow:hidden; }
  .gallery-track { display:flex; gap:12px; transition: transform 450ms cubic-bezier(.2,.8,.2,1); will-change: transform; }
  .slide { flex: 0 0 calc(33.3333% - 8px); box-sizing:border-box; min-width: 0; }
  .slide img { display:block; width:100%; height:300px; object-fit:cover; border-radius:10px; }
  .caption { text-align:center; margin-top:8px; color:#f9b17a; font-weight:700; }
  .arrow { position:absolute; top:50%; transform:translateY(-50%); width:48px; height:48px; border-radius:50%; border:0; background:var(--accent); color:#fff; display:flex; align-items:center; justify-content:center; cursor:pointer; font-size:22px; box-shadow:0 6px 18px rgba(0,0,0,0.45); z-index: 10; }
  .arrow-left { left:12px; }
  .arrow-right { right:12px; }
  .arrow:active { transform:translateY(-50%) scale(.97); }
  .arrow:disabled { opacity:0.5; cursor:not-allowed; }
  .pager { text-align:center; margin-top:14px; color:var(--muted); font-size:16px; }
  @media (max-width:768px) {
    .slide { flex: 0 0 100%; }
    .slide img { height: 240px; }
    .arrow { width:40px; height:40px; font-size:18px; }
  }
</style>
</head>
<body>
  <div class="gallery-wrapper" id="gallery-wrapper">
    <button class="arrow arrow-left" id="btn-prev" aria-label="Назад">&#10094;</button>
    <button class="arrow arrow-right" id="btn-next" aria-label="Вперед">&#10095;</button>

    <div class="gallery-track" id="track">
      <div class="slide"><img src="jojo_images/dio.png" alt="Дио Брандо"><div class="caption">Дио Брандо</div></div>
      <div class="slide"><img src="jojo_images/jotaro.png" alt="Куджо Джотаро"><div class="caption">Куджо Джотаро</div></div>
      <div class="slide"><img src="jojo_images/kira.png" alt="Кира Йошикаге"><div class="caption">Кира Йошикаге</div></div>
      <div class="slide"><img src="jojo_images/rizotto.png" alt="Ризотто Неро"><div class="caption">Ризотто Неро</div></div>
      <div class="slide"><img src="jojo_images/joseph.png" alt="Джозеф Джостар"><div class="caption">Джозеф Джостар</div></div>
      <div class="slide"><img src="jojo_images/polnareff.png" alt="Полнорефф"><div class="caption">Полнорефф</div></div>
      <div class="slide"><img src="jojo_images/abdul.png" alt="Мухаммед Абдул"><div class="caption">Мухаммед Абдул</div></div>
      <div class="slide"><img src="jojo_images/jonathan.png" alt="Джонатан Джостар"><div class="caption">Джонатан Джостар</div></div>
    </div>

    <div class="pager" id="pager">
      <span id="current-page">1</span> из <span id="total-pages">3</span>
    </div>
  </div>

<script>
(function(){
  const track = document.getElementById('track');
  const slides = Array.from(track.querySelectorAll('.slide'));
  const prevBtn = document.getElementById('btn-prev');
  const nextBtn = document.getElementById('btn-next');
  const currentEl = document.getElementById('current-page');
  const totalEl = document.getElementById('total-pages');
  
  let currentPage = 0;
  let slidesPerView = getSlidesPerView();
  const totalSlides = slides.length;
  
  function getSlidesPerView() {
    return window.innerWidth <= 768 ? 1 : 3;
  }
  
  function calculateTotalPages() {
    return Math.max(1, Math.ceil(totalSlides / slidesPerView));
  }
  
  let totalPages = calculateTotalPages();
  
  function updateGallery() {
    // Получаем актуальную ширину слайда и gap
    const slideWidth = slides[0].offsetWidth;
    const gap = 12; // соответствует gap в CSS
    
    // Вычисляем смещение для текущей страницы
    const translateValue = -currentPage * (slideWidth + gap) * slidesPerView;
    track.style.transform = `translateX(${translateValue}px)`;
    
    updatePager();
    updateButtons();
  }
  
  function updatePager() {
    currentEl.textContent = currentPage + 1;
    totalEl.textContent = totalPages;
  }
  
  function updateButtons() {
    prevBtn.disabled = currentPage <= 0;
    nextBtn.disabled = currentPage >= totalPages - 1;
    
    prevBtn.style.opacity = prevBtn.disabled ? '0.5' : '1';
    nextBtn.style.opacity = nextBtn.disabled ? '0.5' : '1';
  }
  
  function nextPage() {
    if (currentPage < totalPages - 1) {
      currentPage++;
      updateGallery();
    }
  }
  
  function prevPage() {
    if (currentPage > 0) {
      currentPage--;
      updateGallery();
    }
  }
  
  function handleResize() {
    const oldSlidesPerView = slidesPerView;
    slidesPerView = getSlidesPerView();
    totalPages = calculateTotalPages();
    
    // Корректируем текущую страницу при изменении layout
    if (oldSlidesPerView !== slidesPerView) {
      currentPage = Math.min(currentPage, totalPages - 1);
    }
    
    updateGallery();
  }
  
  // Инициализация
  prevBtn.addEventListener('click', prevPage);
  nextBtn.addEventListener('click', nextPage);
  
  window.addEventListener('resize', () => {
    clearTimeout(window.resizeTimer);
    window.resizeTimer = setTimeout(handleResize, 250);
  });
  
  // Обработка ошибок загрузки изображений
  slides.forEach(slide => {
    const img = slide.querySelector('img');
    img.addEventListener('error', () => {
      img.src = 'data:image/svg+xml;utf8,' + encodeURIComponent(
        `<svg xmlns="http://www.w3.org/2000/svg" width="1200" height="800"><rect width="100%" height="100%" fill="#444"/><text x="50%" y="50%" fill="#fff" font-size="36" text-anchor="middle" dy=".3em">Изображение недоступно</text></svg>`
      );
    });
  });
  
  // Инициализация при загрузке
  window.addEventListener('load', () => {
    totalPages = calculateTotalPages();
    totalEl.textContent = totalPages;
    updateGallery();
  });
  
  // Первоначальная настройка
  handleResize();
})();
</script>
</body>
</html>